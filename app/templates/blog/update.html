{% extends 'base.html' %}

{% block header %}
  <header>
    <h1>Edit "{{ post['title'] }}"</h1>
  </header>
{% endblock %}

{% block content %}
  <main>
    <article>
      <form method="post" enctype="multipart/form-data">
        <fieldset>
          <legend>Post content</legend>

          <label for="title">Title</label>
          <input type="text" id="title" name="title"
                 value="{{ request.form['title'] or post['title'] }}" required>

          <label for="body">Body</label>
          <textarea id="body" name="body">{{ request.form['body'] or post['body'] }}</textarea>
        </fieldset>

        {% if post['media_filename'] %}
          <section aria-labelledby="current-media">
            <h2 id="current-media">Current Media</h2>

            {% if post['media_type'] == 'image' %}
              <figure>
                <img src="{{ url_for('static', filename='uploads/' ~ post['media_filename']) }}"
                     alt="Image for this post">
                <figcaption>{{ post['media_filename'] }}</figcaption>
              </figure>
            {% elif post['media_type'] == 'video' %}
              <figure>
                <video controls width="300">
                  <source src="{{ url_for('static', filename='uploads/' ~ post['media_filename']) }}">
                  Your browser does not support the video tag.
                </video>
                <figcaption>{{ post['media_filename'] }}</figcaption>
              </figure>
            {% endif %}

            <fieldset>
              <legend>Media options</legend>
              <input type="checkbox" id="remove_file" name="remove_file">
              <label for="remove_file">Remove current media</label>
            </fieldset>
          </section>
        {% endif %}

        <fieldset>
          <legend>Upload new media</legend>
          <label for="file">Choose file</label>
          <input type="file" id="file" name="file">
        </fieldset>

        <button type="submit">Save</button>
      </form>

      <form method="post" action="{{ url_for('blog.delete', id=post['id']) }}">
        <button type="submit" onclick="return confirm('Are you sure?');">Delete</button>
      </form>
    </article>
  </main>
{% endblock %}
